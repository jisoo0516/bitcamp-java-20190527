<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="MemberDao">
	<resultMap type="Member" id="MemberMap">
		<id column="member_id" property="no" />
		<result column="tel" property="phoneNum" />
		<result column="cdt" property="joinDate" />

	</resultMap>
	<select id="findAll" resultMap="MemberMap">
		select
		member_id,
		name,
		email,
		tel,
		cdt
		from lms_member
		order by name asc
	</select>


	<select id="findBy" parameterType="int" resultMap="MemberMap">
		select
		member_id,
		name,
		email,
		tel ,
		cdt
		from lms_member
		where member_id=#{ohoh}
	</select>



	<insert id="insert" parameterType="Member">
		insert into lms_member(name,email,pwd,cdt,tel,photo)
		values(#{name},#{email},password(#{password}),now(),#{phoneNum},#{picture})

	</insert>

	<update id="update" parameterType="Member">
		update lms_member 
		<set>
			<if test="name != null">name=#{name},</if>
			<if test="email != null">email=#{email},</if>
			<if test="password != null">pwd=password(#{password}),</if>
			<if test="phoneNum != null">tel=#{phoneNum},</if>
			<if test="picture != null">photo=#{picture}</if>
		</set>
		where member_id=#{no}
	</update>

	<delete id="delete" parameterType="int">
		delete
		from lms_member
		where member_id=#{no}

	</delete>

	<select id="findByKeyword" parameterType="String"
		resultType="Member">
		select
		member_id as no ,
		name ,
		email ,
		tel as phoneNum,
		cdt as joinDate
		from lms_member
		where name like concat('%', #{value}, '%')
		or email like concat('%', #{value}, '%')
		or tel like concat('%', #{value}, '%')
		order by name asc

	</select>

	<select id="findByEmailPassword" parameterType="Member"
		resultType="Member">
		select
		member_id as no ,
		name as name,
		email as email,
		tel as phoneNum,
		cdt as joinDate
		from lms_member
		where email=#{email} and pwd=password(#{password})
	</select>


</mapper>